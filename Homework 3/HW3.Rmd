---
title: 'Homework #3: Matching'
author: Eric Cheng, Julio Guzman, Vinh Luong, Jorge Ortega, Shao Zhu
output: pdf_document
fontsize: 12
geometry: margin=0.6in
---


# Load Data

```{r}
load("HW3df.rdat")
summary(df)
```


# Some Simple Plots

Distribution of Women Senders:

```{r}
barplot(table(df[df$SenderGender==1, ]$SenderLooks))
```

Distribution of Men Senders:

```{r}
barplot(table(df[df$SenderGender==2, ]$SenderLooks))
```


# Models to Predict Probability of Sending a Message

For Men and Women, we run separate Logit models to capture the impact looks of the receiver have on the probability of sending a message:

```{r}
lres.m = glm(y~ReceiverLooks,data=df[df$SenderGender==2,],family='binomial')
summary(lres.m)
```

```{r}
lres.f = glm(y~ReceiverLooks,data=df[df$SenderGender==1,],family='binomial')
summary(lres.f)
```

```{r}
pred.prob.male=function(Xfemale){
  predict(lres.m,newdata=data.frame(ReceiverLooks=factor(Xfemale,levels=1:11)),type='response')
}

pred.prob.female=function(Xmale){
  predict(lres.f,newdata=data.frame(ReceiverLooks=factor(Xmale,levels=1:11)),type='response')
}
```


# Q1: What can you say about the preferences of sender men and women related to the looks of the receiver? Are there differences across the genders?

For both men and women, it appears that the better looking the receivers are, the higher the probability for the senders to make an initial move. This positive correlation is more profound among males than females, indicating that men generally value appearances more.


# Q2: Does the utility/preference function change depending on the looks of the Sender? Are there differences in how these changes for men and women?

Yes, the utility/preference function changes depending on the looks of the sender and there is difference between men and women.  For both male and female, it seems that that the less good looking the senders, the more likely they are to send a message. However, this effect is more profound amongst the female senders.  Also, for both genders, the less good looking are less likely to initiate a contact with the most good looking (i.e. looks that are rated as 8 or above).  


```{r}
# Here is some code to help:
#     This code estimates preferences for Sender Males with Looks rated less than 6
#      lres.m5 = glm(y~ReceiverLooks,data=df[df$SenderGender==2 & #as.numeric(df$SenderLooks)<6,],family='binomial')
#     We can then create a prediction function

#      pred.prob.m5=function(Xfemale){
#      predict(lres.m5,newdata=data.frame(ReceiverLooks=factor(Xfemale,levels=1:11)),type='response')
#}
```

# Q3: Using the pred.match function explore the match scores between men and women at various looks percentiles. Comment on and explain your findings. For example, you may want to explore why pred.match(2,10) differs from pred.match(10,2).    

Generally speaking, regardless of the genders, the better looking the receivers are, the higher the matching scores. However, it seems that the male cares about look more than female.

```{r}
A = matrix (nrow=11,ncol=11, byrow=TRUE)
for (i in 1:11){
  for (j in 1:11){
  A[i,j]=pred.match(i,j)
  }
}

f(1)=par(mfrow=c(2,2))
for(i in 1:4){
  plot(A[i,1:11],xlab=i, ylab='Match Score',col='blue',type='l')
  lines(A[1:11,i],col='red', type='l')
}

f(2)=par(mfrow=c(2,2))
for(i in 5:8){
  plot(A[i,1:11],xlab=i, ylab='Match Score',col='blue',type='l')
  lines(A[1:11,i],col='red', type='l')
}

f(3)=par(mfrow=c(1,3))
for(i in 9:11){
  plot(A[i,1:11],xlab=i, ylab='Match Score',col='blue',type='l')
  lines(A[1:11,i],col='red', type='l')
}

```
# Q4: (Optional: Warning Difficult and Time Consuming!) How would you change the match function to account for the findings in Q2. How do the results comapre to the original pred.match function results.


